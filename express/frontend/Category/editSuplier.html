<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width-device-width, initial-scale=1.0">
  <title>Edição de Usuário</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/qs@6.9.4/dist/qs.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"
    integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js"
    integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz"
    crossorigin="anonymous"></script>
</head>

<body onload="supplierInfo(supplierId)">
  <h1>Edição de Fornecedor</h1>
  <form>
    <div>
      <label for="nome">Nome: </label>
      <input type="text" id="nameSupplier" name="nome">
    </div>
    <div>
      <label for="email">CNPJ:</label>
      <input type="text" id="cnpjSupplier" name="email">
    </div>
    <div>
      <label for="email">CPF:</label>
      <input type="text" id="cpfSupplier" name="email">
    </div>
    <div>
      <label for="email">CEP:</label>
      <input type="text" id="cepSupplier" name="email">
    </div>
    <div>
      <label for="email">Endereço:</label>
      <input type="text" id="addressSupplier" name="email">
    </div>
    <div>
      <label for="email">Número:</label>
      <input type="text" id="numberAdressSupplier" name="email">
    </div>
    <div>
      <label for="email">Telefone:</label>
      <input type="text" id="phoneSupplier" name="email">
    </div>
    <div>
      <label for="email">UF:</label>
      <input type="text" id="ufSupplier" name="email">
    </div>
  </form>
  <button type="submit" onclick="updateSupplier()">Atualizar</button>


  <script>

    let supplierId = localStorage.getItem("supplierId");

    console.log(supplierId)

    function supplierInfo(supplierId) {

      var config = {
        method: 'get',
        maxBodyLength: Infinity,
        url: `http://localhost:8080/supplier/${supplierId}`,
        headers: {}
      };

      axios(config)
        .then(function (response) {
          document.getElementById("nameSupplier").value = response.data.NOME_FORNE;
          document.getElementById("cnpjSupplier").value = response.data.CNPJ_FORNE;
          document.getElementById("cpfSupplier").value = response.data.CPF_FORNE;
          document.getElementById("cepSupplier").value = response.data.CEP_FORNE;
          document.getElementById("addressSupplier").value = response.data.END_FORNE;
          document.getElementById("numberAdressSupplier").value = response.data.NUM_END_FORNE;
          document.getElementById("phoneSupplier").value = response.data.TELE_FORNE;
          document.getElementById("ufSupplier").value = response.data.UF_FORNE;

          console.log(JSON.stringify(response.data));
          console.log(JSON.stringify(response.data.NOME_FORNE));
        })
        .catch(function (error) {
          console.log(error);
        });
    }

    function updateSupplier() {
      let
        nameSupplier = document.getElementById("nameSupplier").value,
        cnpjSupplier = document.getElementById("cnpjSupplier").value,
        cpfSupplier = document.getElementById("cpfSupplier").value,
        cepSupplier = document.getElementById("cepSupplier").value;
        addressSupplier = document.getElementById("addressSupplier").value;
        numberAdressSupplier = document.getElementById("numberAdressSupplier").value;
        phoneSupplier = document.getElementById("phoneSupplier").value;
        ufSupplier = document.getElementById("ufSupplier").value;
        

      var data = Qs.stringify({

        idSupplier: supplierId,
        nameSupplier: nameSupplier,
        cnpjSupplier: cnpjSupplier,
        cpfSupplier: cpfSupplier,
        cepSupplier: cepSupplier,
        endSupplier: addressSupplier,
        numEndSupplier: numberAdressSupplier,
        TeleSupplier: phoneSupplier,
        ufSupplier: ufSupplier
      });
      var config = {
        method: 'put',
        maxBodyLength: Infinity,
        url: 'http://localhost:8080/supplier',
        headers: {
          'Content-Type': 'application/x-www-form-urlencoded'
        },
        data: data
      };

      axios(config)
        .then(function (response) {
          console.log(JSON.stringify(response.data));
          alert(JSON.stringify(response.data));
          window.location.href = "listSupplier.html";
        })
        .catch(function (error) {
          console.log(error);
          alert("Algo deu errado.");
        });
    }
  </script>
</body>

</html>